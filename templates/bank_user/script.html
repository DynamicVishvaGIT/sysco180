<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>
<script src="https://cdn.datatables.net/2.2.2/js/dataTables.js"></script>
<script src="https://cdn.datatables.net/responsive/3.0.3/js/dataTables.responsive.js"></script>
<script src="https://cdn.datatables.net/responsive/3.0.3/js/responsive.dataTables.js"></script>
<script src="/static//assets/js/script.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    let partyCount = 1;
    const maxParties = 4; // Party 1 + 3 more
    const partiesSection = document.getElementById("parties-section");

    function createPartyRow(count) {
        const partyDiv = document.createElement("div");
        partyDiv.classList.add("row", "mb-2", "party-group", "align-items-center");
        partyDiv.dataset.party = count;

        partyDiv.innerHTML = `
            <div class="col-lg-4">
                <input type="text" class="form-control form_control" name="party_${count}" placeholder="Name">
            </div>
            <div class="col-lg-6">
                <textarea class="form-control form_control" name="party_${count}_add" rows="2" placeholder="Address"></textarea>
            </div>
            <div class="col-lg-2 d-flex">
                <button type="button" class="btn btn-success w-100 add-party-btn me-1">+ Add</button>
                <button type="button" class="btn btn-danger w-100 remove-party">- Delete</button>
            </div>
        `;
        return partyDiv;
    }

    partiesSection.addEventListener("click", function(e){
        // Add button
        if(e.target.classList.contains("add-party-btn")){
            if(partyCount < maxParties){
                partyCount++;
                const newParty = createPartyRow(partyCount);
                partiesSection.appendChild(newParty);

                if(partyCount === maxParties){
                    const addBtns = partiesSection.querySelectorAll(".add-party-btn");
                    addBtns.forEach(btn => btn.disabled = true);
                }
            }
        }

        // Delete button
        if(e.target.classList.contains("remove-party")){
            const partyRow = e.target.closest(".party-group");
            partiesSection.removeChild(partyRow);
            partyCount--;

            const addBtns = partiesSection.querySelectorAll(".add-party-btn");
            addBtns.forEach(btn => btn.disabled = false);
        }
    });
});
</script>




